<!DOCTYPE html>
<html lang="de">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nextlevel-Network</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    body {
      background: black;
      color: white;
      font-family: 'Segoe UI', sans-serif;
      overflow-x: hidden;
    }

    .glow-btn {
      transition: 0.3s;
    }

    .glow-btn:hover {
      box-shadow: 0 0 15px #9f4fff;
      transform: scale(1.05);
    }

    .bg-image {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-image: url('https://i.imgur.com/Bf1vmnS.png');
      background-size: cover;
      background-position: center;
      opacity: 0.15;
      z-index: -2;
    }
  </style>
</head>

<body class="min-h-screen flex flex-col items-center p-6">
  <div class="bg-image"></div>

  <header class="text-center mb-10">
    <h1 class="text-4xl md:text-5xl font-bold text-purple-400 mb-4">Nextlevel-Network</h1>
    <p class="text-lg text-gray-300 max-w-xl">Nextlevel-Network bringt euch alle zu einem Nextlevel-Gaming aus ganz
      Deutschland, Österreich und der Schweiz</p>
    <div id="total-users" class="text-2xl text-green-400 mt-4">Lade aktive Nutzer...</div>
  </header>

  <!-- Anmeldung Panel -->
  <section
    class="panel max-w-lg w-full mb-10 bg-purple-800 rounded-2xl p-5 text-center glow-btn flex flex-col items-center">
    <h2 class="text-2xl font-bold text-purple-400 mb-4">Fragpunk Turnier Anmeldung</h2>
    <form id="registration-form" class="w-full">
      <div class="mb-4">
        <label for="name" class="block text-sm font-medium">Name:</label>
        <input type="text" id="name" class="w-full p-2 rounded bg-gray-800 text-white" required>
      </div>
      <div class="mb-4">
        <label class="block text-sm font-medium">Rank:</label>
        <div id="rank-options" class="flex flex-wrap">
          <!-- Ranks werden dynamisch generiert -->
        </div>
      </div>
      <button type="submit" class="bg-purple-600 text-white px-4 py-2 rounded">Anmelden</button>
      <p id="registration-message" class="mt-4 text-sm"></p>
    </form>
  </section>

  <!-- Admin Panel -->
  <section class="panel max-w-lg w-full bg-purple-800 rounded-2xl p-5 text-center glow-btn flex flex-col items-center">
    <h2 class="text-2xl font-bold text-purple-400 mb-4">Admin Panel</h2>
    <form id="admin-login-form" class="mb-4 w-full">
      <div class="mb-4">
        <label for="admin-password" class="block text-sm font-medium">Admin Passwort:</label>
        <input type="password" id="admin-password" class="w-full p-2 rounded bg-gray-800 text-white" required>
      </div>
      <button type="submit" class="bg-purple-600 text-white px-4 py-2 rounded">Login</button>
    </form>
    <div id="admin-actions" class="hidden w-full">
      <button id="delete-user" class="bg-red-600 text-white px-4 py-2 rounded mb-4 w-full">User löschen</button>
      <button id="delete-all-users" class="bg-red-600 text-white px-4 py-2 rounded w-full">Alle User löschen</button>
    </div>
  </section>

  <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-5xl w-full">
    <a href="https://discord.gg/fragpunkde" target="_blank"
      class="bg-purple-800 rounded-2xl p-5 text-center glow-btn flex flex-col items-center">
      <img src="https://i.imgur.com/qJT9QwP.png" alt="Fragpunk Logo" class="w-12 h-12 mb-2">
      Spiel Fragpunk
      <div id="fragpunk-users" class="text-sm text-green-400">Lade aktive Nutzer...</div>
      <div id="fragpunk-team" class="text-xs text-gray-300 mt-2">Lade Teammitglieder...</div>
    </a>
    <a href="https://discord.gg/NPy3qwW7dE" target="_blank"
      class="bg-purple-800 rounded-2xl p-5 text-center glow-btn flex flex-col items-center">
      <img src="https://i.imgur.com/g9vzzYh.jpeg" alt="Marvel Logo" class="w-12 h-12 mb-2">
      Spiel Marvel Rivals
      <div id="marvel-users" class="text-sm text-green-400">Lade aktive Nutzer...</div>
      <div id="marvel-team" class="text-xs text-gray-300 mt-2">Lade Teammitglieder...</div>
    </a>
    <a href="https://discord.gg/NFwBBc94" target="_blank"
      class="bg-purple-800 rounded-2xl p-5 text-center glow-btn flex flex-col items-center">
      <img src="https://i.imgur.com/FLsEolX.png" alt="Battlefield Logo" class="w-12 h-12 mb-2">
      Spiel Battlefield Labs
      <div id="battlefield-users" class="text-sm text-green-400">Lade aktive Nutzer...</div>
      <div id="battlefield-team" class="text-xs text-gray-300 mt-2">Lade Teammitglieder...</div>
    </a>
    <a href="https://discord.gg/2EWXJnuRby" target="_blank"
      class="bg-purple-800 rounded-2xl p-5 text-center glow-btn flex flex-col items-center">
      <img src="https://i.imgur.com/fcyYWpM.png" alt="MechaBREAK Logo" class="w-12 h-12 mb-2">
      Spiel MechaBREAK
      <div id="mechabreak-users" class="text-sm text-green-400">Lade aktive Nutzer...</div>
      <div id="mechabreak-team" class="text-xs text-gray-300 mt-2">Lade Teammitglieder...</div>
    </a>
    <a href="https://discord.gg/AC6JUGnwTH" target="_blank"
      class="bg-purple-800 rounded-2xl p-5 text-center glow-btn flex flex-col items-center">
      <img src="https://i.imgur.com/AvqJ0bp.png" alt="COD Warzone Logo" class="w-12 h-12 mb-2">
      Call of Duty Warzone
      <div id="cod-users" class="text-sm text-green-400">Lade aktive Nutzer...</div>
      <div id="cod-team" class="text-xs text-gray-300 mt-2">Lade Teammitglieder...</div>
    </a>
  </section>

  <footer class="mt-12 text-gray-500 text-sm">
    &copy; 2025 Nextlevel-Network. All rights reserved.
  </footer>

  <script>
    const serverData = [
      { id: "1325249120918704168", elementId: "fragpunk-users", teamElementId: "fragpunk-team", team: ["User1", "User2"] },
      { id: "1314605130342989885", elementId: "marvel-users", teamElementId: "marvel-team", team: ["User3", "User4"] },
      { id: "1328517357550698576", elementId: "battlefield-users", teamElementId: "battlefield-team", team: ["User5"] },
      { id: "1327026998534737952", elementId: "mechabreak-users", teamElementId: "mechabreak-team", team: ["User6", "User7"] },
      { id: "690916074773938236", elementId: "cod-users", teamElementId: "cod-team", team: ["User8"] },
    ];

    const totalUsersElement = document.getElementById("total-users");
    let totalUsers = 0;

    serverData.forEach((server) => {
      fetch(`https://discord.com/api/guilds/${server.id}/widget.json`)
        .then((response) => response.json())
        .then((data) => {
          const activeUsers = data.presence_count || 0;
          totalUsers += activeUsers;
          document.getElementById(server.elementId).textContent = `${activeUsers} aktive Nutzer`;
          totalUsersElement.textContent = `Gesamt aktive Nutzer: ${totalUsers}`;

          // Zeige Teammitglieder an
          const teamElement = document.getElementById(server.teamElementId);
          teamElement.textContent = `Team: ${server.team.join(", ")}`;
        })
        .catch(() => {
          document.getElementById(server.elementId).textContent = "Fehler beim Laden der Nutzer";
          const teamElement = document.getElementById(server.teamElementId);
          teamElement.textContent = "Fehler beim Laden der Teammitglieder";
        });
    });

    // Google Apps Script Web-App URL
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbx2AYcR-yC4NMWQYKcpmlYH7XKsEC08vXOHYbCc2-IGqkxrU2UfPSmG1XglGCCp2MD2/exec";

    // Ranks
    const ranks = [
      "Bronze 5", "Bronze 4", "Bronze 3", "Bronze 2", "Bronze 1",
      "Silber 5", "Silber 4", "Silber 3", "Silber 2", "Silber 1",
      "Gold 5", "Gold 4", "Gold 3", "Gold 2", "Gold 1",
      "Platin 5", "Platin 4", "Platin 3", "Platin 2", "Platin 1",
      "Diamant 5", "Diamant 4", "Diamant 3", "Diamant 2", "Diamant 1",
      "Master 5", "Master 4", "Master 3", "Master 2", "Master 1",
      "Pankmaster"
    ];

    // Generate rank options
    const rankOptionsContainer = document.getElementById("rank-options");
    ranks.forEach(rank => {
      const rankOption = document.createElement("div");
      rankOption.className = "rank-option bg-gray-800 text-white p-2 rounded m-1 cursor-pointer";
      rankOption.textContent = rank;
      rankOption.addEventListener("click", () => {
        document.querySelectorAll(".rank-option").forEach(option => option.classList.remove("bg-purple-600"));
        rankOption.classList.add("bg-purple-600");
      });
      rankOptionsContainer.appendChild(rankOption);
    });

    // Registration form
    const registrationForm = document.getElementById("registration-form");
    const registrationMessage = document.getElementById("registration-message");

    registrationForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const name = document.getElementById("name").value.trim();
      const selectedRank = document.querySelector(".rank-option.bg-purple-600");

      if (!selectedRank) {
        registrationMessage.textContent = "Bitte wähle einen Rank aus.";
        registrationMessage.style.color = "red";
        return;
      }

      // Senden der Daten an Google Apps Script
      fetch(SCRIPT_URL, {
        method: "POST",
        body: JSON.stringify({ action: "register", name, rank: selectedRank.textContent }),
        headers: { "Content-Type": "application/json" }
      })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            registrationMessage.textContent = "Du hast dich erfolgreich angemeldet!";
            registrationMessage.style.color = "green";
          } else {
            registrationMessage.textContent = data.message || "Fehler bei der Anmeldung.";
            registrationMessage.style.color = "red";
          }
        })
        .catch(error => {
          console.error("Fehler:", error);
          registrationMessage.textContent = "Fehler bei der Anmeldung.";
          registrationMessage.style.color = "red";
        });
    });

    // Admin Panel
    const adminLoginForm = document.getElementById("admin-login-form");
    const adminActions = document.getElementById("admin-actions");
    const adminPassword = "1326";

    adminLoginForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const password = document.getElementById("admin-password").value.trim();
      if (password === adminPassword) {
        adminActions.classList.remove("hidden");
        adminLoginForm.classList.add("hidden");
      } else {
        alert("Falsches Passwort!");
      }
    });

    document.getElementById("delete-user").addEventListener("click", () => {
      const name = prompt("Gib den Namen des Users ein, den du löschen möchtest:");
      if (name) {
        fetch(SCRIPT_URL, {
          method: "POST",
          body: JSON.stringify({ action: "deleteUser", name }),
          headers: { "Content-Type": "application/json" }
        })
          .then(response => response.json())
          .then(data => {
            alert(data.message || "User wurde gelöscht.");
          })
          .catch(error => {
            console.error("Fehler:", error);
            alert("Fehler beim Löschen des Users.");
          });
      }
    });

    document.getElementById("delete-all-users").addEventListener("click", () => {
      if (confirm("Möchtest du wirklich alle User löschen?")) {
        fetch(SCRIPT_URL, {
          method: "POST",
          body: JSON.stringify({ action: "deleteAllUsers" }),
          headers: { "Content-Type": "application/json" }
        })
          .then(response => response.json())
          .then(data => {
            alert(data.message || "Alle User wurden gelöscht.");
          })
          .catch(error => {
            console.error("Fehler:", error);
            alert("Fehler beim Löschen aller User.");
          });
      }
    });
  </script>
</body>

</html>